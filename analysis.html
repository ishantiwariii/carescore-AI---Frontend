<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Analysis Report | CareScore AI</title>

    <link rel="stylesheet" href="css/analysis.css" />

    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
  </head>

  <body>
    <header class="navbar">
      <div class="nav-left">
        <div class="brand">CareScore<span>AI</span></div>
        <ul class="nav-menu">
          <li><a href="dashboard.html">Dashboard</a></li>
          <li><a href="history.html">All Reports</a></li>
          <li><a href="imp.html">Important Reports</a></li>
        </ul>
      </div>
      <button id="logoutBtn" class="logout">Logout</button>
    </header>

    <main class="main-container">
      <div class="top-grid">
        <div class="card score-card">
          <h3>Your Health Score</h3>

          <div class="score-circle-container">
            <svg viewBox="0 0 36 36" class="circular-chart">
              <path
                class="circle-bg"
                d="M18 2.0845
                   a 15.9155 15.9155 0 0 1 0 31.831
                   a 15.9155 15.9155 0 0 1 0 -31.831"
              />
              <path
                class="circle"
                id="scoreCircle"
                stroke-dasharray="0, 100"
                d="M18 2.0845
                   a 15.9155 15.9155 0 0 1 0 31.831
                   a 15.9155 15.9155 0 0 1 0 -31.831"
              />
              <text x="18" y="20.35" class="percentage" id="scoreText">0</text>
            </svg>
          </div>

          <p id="scoreLabel" class="score-label">Calculating...</p>
        </div>

        <div class="card insight-card">
          <h3>ðŸ¤– AI Analysis</h3>
          <div id="aiExplanation" class="ai-text">Loading analysisâ€¦</div>
          <div class="tags" id="deviationTags"></div>
        </div>
      </div>

      <div class="details-grid">
        <!-- PLOTLY CHART -->
        <div class="card graph-card">
          <h3>Biomarker Overview</h3>
          <div id="healthChart" style="height: 320px"></div>
        </div>

        <div class="card list-card">
          <h3>Test Results</h3>
          <div class="table-wrapper">
            <table class="results-table">
              <thead>
                <tr>
                  <th>Test</th>
                  <th>Value</th>
                  <th>Unit</th>
                  <th>Reference Range</th>
                </tr>
              </thead>

              <tbody id="resultsTableBody">
                <tr>
                  <td colspan="5" class="muted">Loading test resultsâ€¦</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <div class="action-bar">
        <button id="downloadBtn" class="btn-primary">
          â¬‡ Download Full Report (PDF)
        </button>
        <a href="history.html" class="btn-text">Back to History</a>
      </div>
    </main>

    <script src="js/auth_guard.js"></script>
    <script src="js/analysis.js"></script>
  </body>
</html>
